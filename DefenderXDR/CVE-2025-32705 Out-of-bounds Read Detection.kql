// CVE-2025-32705 Out-of-bounds Read Detection

let InboundMailAttachment =
EmailAttachmentInfo
| where Timestamp > ago(1h)
| join EmailEvents on NetworkMessageId
| where EmailDirection == "Inbound" and LatestDeliveryAction != "Blocked"
| distinct FileName;
let VulnerableEP =
DeviceTvmSoftwareVulnerabilities 
| where CveId == "CVE-2025-32705"
| distinct DeviceName;
let MailAttachmentOpen =
DeviceFileEvents
| where Timestamp > ago(1h) 
| where ActionType == "FileCreated"
| where InitiatingProcessFileName == "outlook.exe"
| where FileName has_any(InboundMailAttachment) and DeviceName has_any(VulnerableEP)
| distinct DeviceName;
DeviceEvents
| where Timestamp > ago(1h)
| where ActionType == "ReadProcessMemoryApiCall"
| where DeviceName has_any(MailAttachmentOpen) 

